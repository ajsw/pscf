This implementation of PSCF (Probable Source Contribution Function) is
based on a interpretation of Pekney et al. (2006). It is written
mostly in R with S4 object classes to provide multimethods for mapping
functionality, though these details are largely hidden from
users. This particular algorithm and its implementation has been used
to generate PSCF and trajectory maps by Liu et al. (2009), Bahadur et
al. (2010), Day et al. (2010), Hawkins and Russell (2010), Russell et
al. (2010), Schwartz et al. (2010), Shaw et al. (2010), Frossard et
al. (2011), Liu et al. (2011), Takahama et al. (2011), though the
authors of these manuscripts have touched up their figures for
publication using additional graphics editor software. The author of
this program has recently discovered that there is also a program
called TrajStat, distributed through the NOAA ARL website, which
provides the similar (possibly more advanced) functionality for PSCF
analysis of airmass backtrajectories.

Based on meteorological backtrajectories generated by HYSPLIT, this
collection of scripts can be used to generate PSCF maps, density maps,
and colored backtrajectory maps for groupings of the user's
choosing. Concentrationed-Weighted Trajectory analysis (CWT) and
Residence Time Analysis (RTA) can also be implemented using the
functions provided here.

Utility scripts to download meteorological files and run HYSPLIT in
batch-mode are included.

Instructions and demonstration of included functions are included as
'Instructions.pdf' and 'PSCFdemo.pdf', respectively. Since the
creation of the instructions document, an R-only implementation of
'runHYSPLIT.py' has been added -- if HYSPLIT is being run on a Windows
virtual machine (e.g., through VirtualBox or Parallels), Python would
not have to be additionally installed to run HYSPLIT as was previously
required. For this configuration, R is the only additional program
required on the guest OS (R is assumed to be installed for generating
PMF [Positive Matrix Factorization] solutions in batch-mode
[distributed as a separate program]).

The 'getmetfiles.py' script can generate a list of metfiles required
by the range of times specified in the input file (nominally,
'userinputs/input.txt', generated by 'generateInputs.r') and obtain
them using wget or curl. For users of HYSPLIT on a Windows virtual
machine, this script can be run on the Mac/Linux host and the
meteorological files can be downloaded to a shared folder [appearing
as a mapped network drive on the Windows side].

TODO:
- use rasterImage() in place of image().
- originally migrated from SVN. keywords removed, but add git attributes.

References:
- Bahadur, R., Uplinger, T., Russell, L. M., Sive, B. C., Cliff,
  S. S., Millet, D. B., Goldstein, A., Bates, T. S., 2010. Phenol
  Groups in Northeastern US Submicrometer Aerosol Particles Produced
  from Seawater sources. Environmental Science & Technology 44 (7),
  2542–2548.
- Day, D. A., Liu, S., Russell, L. M., Ziemann, P. J.,
  2010. Organonitrate group concentrations in submicron particles with
  high nitrate and organic fractions in coastal southern
  california. Atmospheric Environment 44 (16), 1970–1979.
- Frossard, A. A., Shaw, P. M., Russell, L. M., Kroll, J. H.,
  Canagaratna, M. R., Worsnop, D. R., Quinn, P. K., Bates, T. S.,
  2011. Springtime arctic haze contributions of submicron organic
  particles from european and asian combustion
  sources. J. Geophys. Res 116 (D05205).
- Hawkins, L. N., Russell, L. M., 2010. Oxidation of ketone groups in
  transported biomass burning aerosol from the 2008 Northern
  California Lightning Series ﬁres. Atmospheric Environment 44 (34),
  4142–4154. Liu, S., Day, D. A., Shields, J. E., Russell, L. M.,
  2011. Ozone-driven photochemical formation of carboxylic acid groups
  from alkane groups. Atmospheric Chemistry and Physics Discussions 11
  (3), 7189–7233. URL 
  http://www.atmos-chem-phys-discuss.net/11/7189/2011/
- Liu, S., Takahama, S., Russell, L. M., Gilardoni, S., Baumgardner,
  D., 2009. Oxygenated organic functional groups and their sources in
  single and submicron organic particles in MILAGRO 2006
  campaign. Atmospheric Chem. Phys. 9 (18), 6849–6863.
- Russell, L. M., Hawkins, L. N., Frossard, A. A., Quinn, P. K.,
  Bates, T. S., 2010. Carbohydrate-like composition of submicron
  atmospheric particles and their production from ocean bubble
  bursting. Proc. National Acad. Sciences United States Am. 107 (15),
  6652–6657.
- Schwartz, R. E., Russell, L. M., Sjostedt, S. J., Vlasenko, A.,
  Slowik, J. G., Abbatt, J. P. D., Macdonald, A. M., Li, S. M.,
  Liggio, J., Toom-Sauntry, D., Leaitch, W. R., 2010. Biogenic
  oxidized organic functional groups in aerosol particles from a
  mountain forest site and their similarities to laboratory chamber
  products. Atmospheric Chem. Phys. 10 (11), 5075–5088.
- Shaw, P. M., Russell, L. M., Jeﬀerson, A., Quinn, P. K.,
  2010. Arctic organic aerosol measurements show particles from mixed
  combustion in spring haze and from frost flowers in
  winter. Geophysical Research Lett. 37.
- Takahama, S., Schwartz, R. E., Russell, L. M., Macdonald, A. M.,
  Sharma, S., Leaitch, W. R., 2011. Organic functional groups in
  aerosol particles from burning and non-burning forest emissions at a
  high-elevation mountain site. Atmospheric Chemistry and Physics
  Discussions 11 (1), 2655–2696. URL 
  http://www.atmos-chem-phys-discuss.net/11/2655/2011/
